/**
 *******************************************************************************
 * scopelock.h                                                                 *
 *                                                                             *
 * Scope lock                                                                  *
 *   Implement pthread mutex that unlock when leaving scope                    *
 *******************************************************************************
 */

#ifndef _SCOPE_LOCK_H_
#define _SCOPE_LOCK_H_

/*
 *******************************************************************************
 *  Headers                                                                    *
 *******************************************************************************
 */
#include <pthread.h>
#include <time.h>

/*
 *******************************************************************************
 *  Macros                                                                     *
 *******************************************************************************
 */

/*
 *******************************************************************************
 *  Forward declaraction                                                       *
 *******************************************************************************
 */


/*
 *******************************************************************************
 *  Class declaraction                                                         *
 *******************************************************************************
 */

class ScopeLock {
public:
    ScopeLock(pthread_mutex_t * mutex);
    ~ScopeLock();

    bool lock();
    bool timedlock(struct timespec * );
    bool trylock();
    void unlock();
private:
    pthread_mutex_t  * m_pmutex;
};

/*
 *******************************************************************************
 *  Inline functions                                                           *
 *******************************************************************************
 */


#endif // _SCOPE_LOCK_H_

